<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Digital Image Correlation Engine: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Digital Image Correlation Engine
   &#160;<span id="projectnumber">Version of the Day</span>
   </div>
   <div id="projectbrief">A modular, high-performance, image correlation tool used to compute full-field displacements and strains from digital images</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Digital Image Correlation Engine Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Copyright 2015 Sandia Corporation. Under the terms of Contract DE-AC04-94AL85000 with Sandia Corporation, the U.S. Government retains certain rights in this software.</p>
<p><a href="http://dice.sandia.gov">DICe Home Page</a></p>
<p><a href="#GettingStarted">Getting Started</a></p>
<p><a href="#UserManual">User Manual</a></p>
<p><a href="#DICESource">Obtaining DICe source code</a></p>
<p><a href="#BuildingDICE">Building DICe</a></p>
<p><a href="#CodeDesign">Code Design</a></p>
<p><a href="#Legal">Legal</a></p>
<h1>Introduction </h1>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is an open source digital image correlation (DIC) tool intended for use as a module in an external application or as a standalone analysis code. Its primary capability is computing full-field displacements and strains from sequences of digital images. These images are typically of a material sample undergoing a characterization experiment, but <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is also useful for other applications (for example, trajectory tracking and object classification). <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is machine portable (Windows, Linux and Mac) and can be effectively deployed on a high performance computing platform (<a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> uses MPI parallelism as well as threaded on-core parallelism). Capabilities from <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> can be invoked through a customized library interface, via source code integration of <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> classes or through a standalone executable.</p>
<p>DIC, in general, has become a popular means of determining full-field displacements from digital images, it has also become a vital component in material characterization applications that use full-field information as part of a parameter inversion process. DIC is also used extensively for constitutive model development and validation as well as physics code validation. <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> intends to enable more seamless integration of DIC in these types of applications by providing a DIC tool that can be directly incorporated in an external application.</p>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is different than other available DIC codes in the following ways: First, subsets can be of arbitrary shape. This enables tracking of oblong objects that otherwise would not be trackable with a square subset. <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> also incudes a robust simplex optimization method that does not use image gradients (this method is useful for data sets that are impossible to analyze with the traditional Lucas-Kanade-type algorithms, for example, objects without speckles, images with low contrast, and small subset sizes &lt; 10 pixels). Lastly, <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> also includes a well-posed global DIC formulation that addresses instabilities associated with the saddle-point problem in DIC (This capability will be released later this year).</p>
<p>The DIC engine concept is meant to represent the code's flexibility in terms of using it as a plug-in component in a larger application. It is also meant to represent the ease with which various algorithms can be hot-swapped to create a customized DIC kernel for a particular application.</p>
<h2>Features </h2>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> has a number of attractive features, including the following:</p>
<ul>
<li>Both local and global DIC algorithms</li>
<li>Conformal subsets of arbitrary shape (for local DIC)</li>
<li>MPI enabled parallelism</li>
<li>Convolution-based interpolation functions that perform nearly as well as quintic splines at a fraction of the compute time</li>
<li>Zero-normalized sum squared differences (ZNSSD) correlation criteria</li>
<li>Gradient-based optimization as well as simplex-based (that requires no image gradients)</li>
<li>User specified activation of various shape functions (translation, rotation, normal strain and shearing)</li>
<li>User specified arrangement of correlation points that can be adaptively refined (for local DIC)</li>
<li>Robust strain calculation capabilities for treating discontinuities and high strain gradients</li>
<li>Extensive regression testing and unit tests</li>
</ul>
<h2>Contact Information </h2>
<p>For questions, contact Dan Turner, email <code>dzturne@sandia.gov</code>, phone (505) 845-7446.</p>
<h1><a class="anchor" id="GettingStarted"></a>Getting Started </h1>
<p>There are three modes in which <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> can be used.</p>
<ul>
<li>As a standalone executable</li>
<li>As integrated code in an external application by static linking to <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a></li>
<li>As a dynalically linked library</li>
</ul>
<h2><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> standalone use </h2>
<p>To use <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> in standalone mode (assuming the <code>dice</code> executable is built and in the system path), the user simply has to write an input file and invoke <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> with </p><pre class="fragment">$ dice -i &lt;input_file&gt;
</pre><p>The input file is an <code>.xml</code> formated set of parameters. To generate a template set of input files (which includes the input file and the correaltion paramters file, described below) add the <code>-g</code> option to the <code>dice</code> call. </p><pre class="fragment">$ dice -g [file_prefix]
</pre><p>Commented notes on all of the paramters in the input files are given with the <code>-g</code> option in the template files. The input file specifies, the location of the images and results and also the images to use. The user can select a correlation of a list of specific images or a sequence of images based on which paramters are specified.</p>
<p>If MPI is enabled (<a href="#MPINotes">see below</a>) <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is run in parallel with </p><pre class="fragment">$ mpirun -n &lt;num_procs&gt; dice -i &lt;input_file&gt;
</pre><p>Where <code>num_procs</code> specifies the number of processors.</p>
<h3><a class="anchor" id="MPINotes"></a>Running <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> in parallel with MPI enabled</h3>
<p>To run <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> in parallel with MPI enabled, Trilinos must be installed with MPI enabled by setting the approprate flag in the trilinos CMake script </p><pre class="fragment">-D Trilinos_ENABLE_MPI:BOOL=ON
</pre><p>When <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> is configured before building, CMake will default to using the same compilers that were used to build Trilinos. Nothing extra has to be done in the <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> CMake scripts to enable MPI parallelism.</p>
<p>There are three ways that the subsets can be decomposed over the set of processors. If the initialization method is <code>USE_FIELD_VALUES</code> (no neighbor solution is needed to initialize each frame's solution) the subsets will be split up evenly across the number of processors. If the initialization method is <code>USE_NEIGHBOR_VALUES</code> the subsets will be split into groups that share a common seed. In this case, the maximum number of processors in use will be equal to the number of seeds that are specified in the input. If more processors are requested than seeds, the extra processors will remain idle with not subsets to evaluate. A third case involves the initialization method being <code>USE_NEIGHBOR_VALUE_FIRST_STEP_ONLY</code>. In this case, the decomposition of subsets will be the same as <code>USE_NEIGHBOR_VALUES</code>, but only for the first frame. If the analysis involves more than one frame, for subsequent frames the subsets will be split evenly over the number of processors available, regardless of how many seeds are specified.</p>
<p>The solution output from a parallel run will be concatenated into one file, written by process 0. Timing files, on the other hand, are written for each processor individually. The file naming convention for parallel runs is </p><pre class="fragment">&lt;output_file_prefix&gt;_&lt;image_frame&gt;.&lt;num_procs&gt;.txt
</pre><p>The file naming convention for timing files is </p><pre class="fragment">timing.&lt;num_procs&gt;.&lt;proc_id&gt;.txt
</pre><h1><a class="anchor" id="UserManual"></a>User Manual </h1>
<h3>User specified correlation parameters</h3>
<p>Correlation paramters (for example, the interpolation method or how the image gradients are computed) can be set in a separate <code>.xml</code> file. We refer to this file as the correlation parameters file. To include user defined correlation parameters, specify the following option in the input file </p><pre class="fragment">&lt;Parameter name="correlation_parameters_file" type="string" value="&lt;file_name&gt;" /&gt;
</pre><p>If a correlation parameter is not specified in this file, the default value is used.</p>
<h3>User defined correlation point locations</h3>
<p>In many cases, the locations of the correlation points are equally spaced on a grid in the image. The user need not add any options to the input parameters for this default case. In other cases, the user may wish to specify the coordinates of the correlation points as well as use conformal subsets that trace objects in the image rather than use square subsets. Any combination of square and conformal subsets can be used in <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> for the same analysis. The user can specify custom coordinates and conformal subsets using a subset file with a certain syntax (Note: The <code>-g</code> option will not generate a template subset file). If a subset file is used, the coordinate list is mandatory, but the conformal subset definitions are optional. If a conformal subset definition is not provided in the subset file for a subset, it is assumed that the subset is square and will be sized according to the <code>subset_size</code> parameter in the input file. (If all of the subsets in the subset file are conformal, the user does not have to specify the <code>subset_size</code> in the input file.) The ids of the subsets are assigned according to the given coordinates, the first set of coordinates being subset id 0.</p>
<p>The name of the subset file is specified with the following option in the input file: </p><pre class="fragment">&lt;Parameter name="subset_file" type="string" value="&lt;file_name&gt;" /&gt;  
</pre><p>If a subset file is specified, the <code>step_size</code> parameter should not be used and will cause an error. The subset locations file should be a text file with the following syntax. Comments are denoted by <code>#</code> characters. Lines beginning with <code>#</code> or blank lines will not be parsed. Upper and lower case can be used, the parser will automatically convert all text to upper case during parsing.</p>
<p>The first section of the subset file is a mandatory listing of centroid coordinates. The coordinate system has its origin at the upper left corner of the image with x positive to the right and y positive downward. The coordinate listing should begin with the command <code>BEGIN SUBSET_COORDINATES</code> and end with <code>END SUBSET_COORDINATES</code> and have the x and y coordinates of each subset listed in between. For example, if the user would like five subsets with centroids at (126,157), (125,250), (397,139), (177,314) and (395,405) this section of the subset file would look like: </p><pre class="fragment">BEGIN SUBSET_COORDINATES
  126 157
  # comment row will get skipped
  125 250
  397 139 # comment can go after a number

  # blank row above will get skipped
  177 314
  395 405
END SUBSET_COORDINATES
</pre><p>If this is all the content in the subset file, five square subsets will be generated with the centroids as given above and a subset size as specified in the input params file.</p>
<h3>Regions of interest and seeding</h3>
<p>In some instances, the user may wish to specify certain regions of an image to correlate, but without having to define the coordinates of each point. In this case the user can include a REGION_OF_INTEREST block in the subset file. This block uses common shapes to build up an active sub-area of the image. There are two parts to a REGION_OF_INTEREST definition, the boundary definition and an optional excluded area. Correlation points will be evenly spaced in the REGION_OF_INTEREST according to the step_size parameter. Multiple REGION_OF_INTEREST blocks can be included in the subset file. An example REGION_OF_INTEREST block is given below. Valid shapes include the same as those defined below for conformal subsets. </p><pre class="fragment">BEGIN REGION_OF_INTEREST
  BEGIN BOUNDARY
    BEGIN RECTANGLE
      CENTER &lt;X&gt; &lt;Y&gt;
      WIDTH &lt;W&gt;
      HEIGHT &lt;H&gt;
    END
    # Other shapes can be defined (the union of these shapes will define the ROI)
  END
  # Use optional BEGIN EXCLUDED to define interior shapes to omit from the ROI
END
</pre><p>To seed the solution process, the following command block can be used </p><pre class="fragment">BEGIN REGION_OF_INTEREST
  BEGIN BOUNDARY
    ...
  END BOUNDARY
  BEGIN SEED
    LOCATION &lt;X&gt; &lt;Y&gt; # nearest correlation point to these coordinates will be used
    DISPLACEMENT &lt;UX&gt; &lt;UY&gt;
    # OPTIONAL: NORMAL_STRAIN &lt;EX&gt; &lt;EY&gt;
    # OPTIONAL: SHEAR_STRAIN &lt;GAMMA_XY&gt;
    # OPTIONAL: ROTATION &lt;THETA&gt; 
  END
END
</pre><p>If the optional BEGIN_SEED command is used in a REGION_OF_INTEREST block, the correlation points will be computed in an order that begins with the seed location and branches out to the rest of the domain. The initializiation method for a seeded analysis should be USE_NEIGHBOR_VALUES or USE_NEIGHBOR_VALUES_FIRST_STEP_ONLY. Only one seed can be specified for each REGION_OF_INTEREST.</p>
<h3>Conformal subsets</h3>
<p><b>Note: conformal subsets require the the coordinates of the subsets are specified with a SUBSET_COORDINATES block in the subset file as described above. Conformal subsets cannot be used in combination with regions of interest.</b></p>
<p>The user may wish to use conformal subsets for some or all of the subsets in an analysis. Conformal subsets can be helpful if the tracked object is of an odd shape. This allows more speckles to be included in the correlation. There are also a number of features for conformal subsets that are useful for trajectory tracking. For example, there are ways to enable tracking objects that cross each other's path or become partially obscured by another object. Conformal subsets can also evolved through an image sequence to build up the intensity profile if the object is not fully visible at the start of a sequence.</p>
<p>Conformal subsets are created by specifying the geometry using shapes. There are three attributes of a conformal subset that can be specified using sets of shapes. The first the <code>BOUNDARY</code> of the subset. This represents the outer circumference of the subset. The second is the <code>EXCLUDED</code> area. This represents any area internal to the subset that the user wishes to ignore (see below regarding evolving subsets). Lastly, an <code>OBSTRUCTED</code> area can be defined. Obstructions are fixed regions in the image in which pixels should be deactivated if they fall in this region. For example if the user is tracking a vehicle through the frame, and it passed behind a light post, the light post should be defined using an obstructed area.</p>
<p><b>Note: For trajectory tracking and evolving subsets, the <code>SL_ROUTINE</code> <code>correlation_routine</code> should be used.</b></p>
<p>For each conformal subset, the following syntax should be used to define these three sets of shapes. Note, the <code>BOUNDARY</code> and <code>SUBSET_ID</code> are required, but the <code>EXCLUDED</code> and <code>OBSTRUCTED</code> sections are optional. Continuing with the example subset file above, after the coordinates are listed, we wish to denote that subset 2 (with centroid coordinates (397 139)) is a conformal subset made up of an odd shape made of two polygons and a circle. The subset file text for this subset would be </p><pre class="fragment">BEGIN CONFORMAL_SUBSET
  SUBSET_ID 2 # required id of the subset
  BEGIN BOUNDARY # defines the outer boundary of the subset

    BEGIN POLYGON
      BEGIN VERTICES
        # needs at least 3
        # polygon points only need to be listed once, the last segment will close the polygon
        # by connecting the last point with the first
        307 136
        352 86
        426 109
        421 243
        372 143 # comment after vertex value for testing
      END VERTICES
    END POLYGON

    BEGIN CIRCLE
      CENTER 362 201
      RADIUS 45
    END CIRCLE

    BEGIN POLYGON
      BEGIN VERTICES
        359 228
        455 175
        437 267
      END VERTICES
    END POLYGON

  END BOUNDARY    
END CONFORMAL_SUBSET
</pre><p>Available shapes include the following and their syntaxes </p><pre class="fragment">BEGIN POLYGON
  BEGIN VERTICES
    &lt;X&gt; &lt;Y&gt;
    ...
  END VERTICES
END POLYGON

BEGIN CIRCLE
  CENTER &lt;X&gt; &lt;Y&gt;
  RADIUS &lt;R&gt;
END CIRCLE

BEGIN RECTANGLE
  CENTER &lt;X&gt; &lt;Y&gt;
  WIDTH &lt;W&gt;
  HEIGHT &lt;H&gt;
END RECTANGLE

BEGIN RECTANGLE
  UPPER_LEFT &lt;X&gt; &lt;Y&gt;
  LOWER_RIGHT &lt;X&gt; &lt;Y&gt;
END RECTANGLE
</pre><p>Sets of shapes used to define an attribute of a conformal subset can overlap. The pixels inside the overlap will only be included once. An example conformal subset definition that include all three attributes defined is as follows. This subset has a circular boundary, a triangular region to be excluded and an obstruction along the bottom edge. </p><pre class="fragment">BEGIN CONFORMAL_SUBSET
  SUBSET_ID 3
  BEGIN BOUNDARY
    BEGIN CIRCLE
      CENTER 178 352
      RADIUS 64
    END CIRCLE
  END BOUNDARY
  BEGIN EXCLUDED # (optional) defines internal regions that should initially be excluded because they are blocked
    BEGIN POLYGON
      BEGIN VERTICES
        148 341
        160 374
        205 340
      END VERTICES
    END POLYGON
  END EXCLUDED
  BEGIN OBSTRUCTED # (optional) defines objects that do not move that could obstruct the subset
    BEGIN POLYGON
      BEGIN VERTICES
        130 423
        252 366
        266 402
        148 460
      END VERTICES
    END POLYGON
  END OBSTRUCTED
  BEGIN BLOCKING_SUBSETS # (optional) list of other subset global ids that could block this one
    0  # one subset per line
    2  # the ids are assigned as the order of the subset centroid coordinates vector
  END BLOCKING_SUBSETS
END CONFORMAL_SUBSET
</pre><p>The optional <code>BLOCKING_SUBSETS</code> section of the conformal subset definition above lists other subsets in the analysis that may cross paths with this subset. After each frame, pixels are deactivated from this subset if their location coincides with one of the listed blocking subsets. This is useful mostly for trajectory tracking.</p>
<p>An excluded area can be used to generate a hole in the subset and can also be used to denote an area that may be initially obstructed by an object in the image and therefore not visible. The reason a user may wish to treat this area as excluded rather than draw the subset around it is because if pixels in the excluded area become visible later in the image sequence the user can request that these pixels become activated. If the correlation parameter </p><pre class="fragment">&lt;Parameter name="use_subset_evolution" type="bool" value="true" /&gt;
</pre><p>is used, after each frame, the pixels in the excluded area are tested to see if they are now visible. If so, the pixel intensity value from the deformed image is used to evolve the reference pixel intensity that was initially not known. In this way, the subset intensity profile evolves as more regions become visible.</p>
<p>When obstructions or blocking subsets are used, the user can specify the size of the buffer that is constructed surrouding the obstructions, effectively enlarging them. To specify the buffer size use the following option </p><pre class="fragment">&lt;Parameter name="obstruction_buffer_size" type="int" value="&lt;size&gt;"
</pre><p>The default value for the buffer size is 3 pixels.</p>
<p>The solution values can be seeded for a conformal subset by adding a SEED command block to the CONFORMAL_SUBSET command block. For example, </p><pre class="fragment">BEGIN CONFORMAL_SUBSET
  ....
  BEGIN SEED
    DISPLACEMENT &lt;UX&gt; &lt;UY&gt;
    NORMAL_STRAIN &lt;EX&gt; &lt;EY&gt;
    SHEAR_STRAIN &lt;GAMMA_XY&gt;
    ROTATION &lt;THETA&gt;
  END SEED
END CONFORMAL_SUBSET
</pre><p>Note that the location of the seed is automatically the subset centroid and cannot be specified (as it is in a REGION_OF_INTEREST). The displacement guess for a seed is required. All other initial values (shear strain, etc.) are optional.</p>
<p>The conformal and square subsets from the example above are shown in the image below. Note the subset shapes, exclusions etc. are simply a random example to illustrate the syntax, not a meaningful way to set up an analysis.</p>
<div class="image">
<img src="SubsetDefs.png" alt="SubsetDefs.png"/>
</div>
 <h3>Shape functions</h3>
<p>The user can select which shape functions are used to evaluate the correlation between subsets. By "shape
functions" we are referring to the parameters used in the mapping of a subset from the reference to the deformed frame of reference. There are four sets of shape functions available in <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a>: translation, rotation, normal strain and shear strain. To manually specify which shape functions should be used, the user can add the following options to the correlation parameters file </p><pre class="fragment">&lt;Parameter name="enable_translation" type="bool" value="&lt;true/false&gt;" /&gt;
&lt;Parameter name="enable_rotation" type="bool" value="&lt;true/false&gt;" /&gt;
&lt;Parameter name="enable_normal_strain" type="bool" value="&lt;true/false&gt;" /&gt;
&lt;Parameter name="enable_shear_strain" type="bool" value="&lt;true/false&gt;" /&gt;
</pre><p>See <a class="el" href="class_d_i_ce_1_1_subset.html">DICe::Subset</a> for information on how these parameters are used in constructing a deformed subset.</p>
<h3>Output files</h3>
<p>The output produced will be ASCII space delimited text files. The default output is one file per deformed image listing the solution variables for each subset. In the default case, the index at the end of the file name refers to the image id or frame number.</p>
<p>The user can alternatively request output as a separate file for each subset listing the solution variables for each deformed image or frame. To do so set the following option in the input file </p><pre class="fragment">&lt;Parameter name="separate_output_file_for_each_subset" type="bool" value="true" /&gt;
</pre><p>If the separate file for each subset option is employed, the index at the end of the filename refers to the subset id.</p>
<p>The file name prefix to use for the output files can be set with the following option </p><pre class="fragment">&lt;Parameter name="output_prefix" type="string" value="&lt;file_name_prefix&gt;" /&gt;
</pre><p>The user can also define an output specification to list the fields in a specific order and choose which fields to output. To define the output fields and the order, an <code>output_spec</code> can be added to the correlation parameters. The following is a syntax example that outputs only three fields in the order <code>COORDINATE_X</code>, <code>COORDINATE_Y</code>, <code>DISPLACEMENT_X</code>: </p><pre class="fragment">&lt;ParameterList name="output_spec"&gt;
   &lt;Parameter name="coordinate_x" type="int" value="0" /&gt;
   &lt;Parameter name="coordinate_y" type="int" value="1" /&gt;
   &lt;Parameter name="displacement_x" type="int" value="2" /&gt;
&lt;/ParameterList&gt;
</pre><p>The integer value for each field name is the rank in the output order (the order is not assumed from the ordering in the parameter list).</p>
<p>The delimiter used in the output file can be set in the parameters file with the following option: </p><pre class="fragment">&lt;Parameter name="output_delimiter" type="string" value="&lt;value&gt;" /&gt;
</pre><p>The user can also request that the row id in the output files be omitted with </p><pre class="fragment">&lt;Parameter name="omit_output_row_id" type="bool" value="true" /&gt;
</pre><h3>Plotting results with python</h3>
<p>Note: Some extra python modules must be installed to use these python scripts.</p>
<p>The following python script can be used to plot the results from a <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> output file. (Note: these are not intended for conformal subsets if they are defined). If the output files are in the default format of one output file per image with a listing of subset variables in columns with one subset per row, the following python script can be used to create a two-dimensional contour plot. This example also assumes that the output specification has the fields in the default order. </p><pre class="fragment">#Import everything from matplotlib (numpy is accessible via 'np' alias)
from pylab import *
import matplotlib.pyplot as plt
import matplotlib.tri as tri

# skiprows used to skip the header comments
DATA = loadtxt("&lt;results_folder&gt;/DICE_solution_&lt;#&gt;.txt",skiprows=21)
X = DATA[:,1]
Y = DATA[:,2]
DISP_X = DATA[:,3]
DISP_Y = DATA[:,4]
SIGMA = DATA[:,9]

NUMPTS = len(X)
NUMPTSX = sqrt(NUMPTS)
LINEDISPY = []
LINEY = []
i = NUMPTSX/2
while i &lt; NUMPTS:
    LINEDISPY.append(DISP_Y[i])
    LINEY.append(Y[i])
    i = i + NUMPTSX

OUTFILE_DISPLACEMENT_X = "DICEDispX.pdf"
OUTFILE_DISPLACEMENT_Y = "DICEDispY.pdf"
OUTFILE_SIGMA = "DICECorrSigma.pdf"
OUTFILE_LINEY = "DICELineDispY.pdf"

triang = tri.Triangulation(X, Y)

font = {'family' : 'sans-serif',
    'weight' : 'regular',
    'size'   : 8}
matplotlib.rc('font', **font)

fig = figure(dpi=150)
ax1 = tripcolor(triang, DISP_X, shading='flat', cmap=plt.cm.rainbow)
axis('equal')
xlabel('X (px)')
ylabel('Y (px)')
title('Displacement-X')
plt.gca().invert_yaxis()
colorbar()
savefig(OUTFILE_DISPLACEMENT_X,dpi=150, format='pdf')

fig = figure(dpi=150)
ax2 = plot(LINEY,LINEDISPY,'-')
title('Displacement Y (px)')
xlabel('Y (px)')
ylabel('DISP_Y (px)')
savefig(OUTFILE_LINEY, dpi=150, format='pdf')

#Other figures similar to above
</pre><p>If separate output files were generated for each subset, a time history of the solution variables can be plotted for all subsets with the following script. A separate plot will be created for each subset. </p><pre class="fragment"># Import everything from matplotlib (numpy is accessible via 'np' alias)
from pylab import *
import matplotlib.pyplot as plt

NUM_SUBSETS = &lt;number_of_subsets&gt;
FILE_PREFIX = "&lt;results_folder&gt;/DICE_solution_"

font = {'family' : 'sans-serif',
    'weight' : 'regular',
    'size'   : 8}
matplotlib.rc('font', **font)

for i in range(0,NUM_SUBSETS):
   FILE = FILE_PREFIX+str(i)+".txt"
   PDFU = "DispX_"+str(i)+".pdf"
   PDFV = "DispY_"+str(i)+".pdf"
   PDFTHETA = "Theta_"+str(i)+".pdf"
   print(FILE)

   # skiprows used to skip the header comments
   DATA = loadtxt(FILE,skiprows=21)
   IMAGE   = DATA[:,0]
   DISP_X  = DATA[:,3]
   DISP_Y  = DATA[:,4]
   THETA   = DATA[:,5]
   SIGMA   = DATA[:,9]
   FLAG    = DATA[:,10]

   fig = figure(figsize=(12,5), dpi=150)
   plot(IMAGE,THETA,'-b')
   fig.set_tight_layout(True)
   xlabel('Image Number')
   xlim(0.0,18074.0)
   savefig(PDFTHETA,dpi=150, format='pdf')

   fig = figure(figsize=(12,5), dpi=150)
   plot(IMAGE,DISP_X,'-b')
   fig.set_tight_layout(True)
   xlabel('Image Number')
   ylabel('Displacement X')
   xlim(0.0,18074.0)
   savefig(PDFU,dpi=150, format='pdf')

   fig = figure(figsize=(12,5), dpi=150)
   plot(IMAGE,DISP_Y,'-b')
   fig.set_tight_layout(True)
   xlabel('Image Number')
   ylabel('Displacement Y')
   xlim(0.0,18074.0)
   savefig(PDFV,dpi=150, format='pdf')

#show()   
</pre><p>The python scripts above are only meant to provide a simple example. Obviously, there are many ways python can be used to generate more sophisticated plots.</p>
<h2>Incorporating <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> in an external application with static linking </h2>
<p>To use <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> correlation capabilities in an external application the developer need only include the <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> header files and link to <code>libdicecore</code>, which resides in the <code>\dice\build\src\</code> folder.</p>
<p>The following code is a simple <code>.cpp</code> file that can be used as a template for using <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> in a C++ application. Each line is described in the comments above the code line. (Note: this example assumes boost is enabled, so that tiff files can be read)</p>
<p>The process of performing a correlation involves three steps, first a <a class="el" href="class_d_i_ce_1_1_schema.html" title="The centralized container for the correlation plan and parameters. ">DICe::Schema</a> must be instantiated by calling its constructor. Then the schema must be initialized (which resizes the field arrays, etc.). Lastly, the correlation is exectued. </p><pre class="fragment">#include &lt;DICE_Types.h&gt;
#include &lt;DICE_Schema.h&gt;

int main(int argc, char *argv[]) {

  // set up the correlation parameters
  Teuchos::RCP&lt;Teuchos::ParameterList&gt; params = 
      rcp(new Teuchos::ParameterList());
  params-&gt;set("enable_rotation",false);
  params-&gt;set("enable_normal_strain",true);
  params-&gt;set("correlation_method", DICE::SSD);
  // many other options possible ...

  // create a schema to orchestrate the correlation
  DICE::Schema&lt;RealT,SizeT&gt; schema("./smoothRef.tif","./smoothDef.tif",params);

  // initialize the schema by setting the spacing of control 
  // points using a constant width and height
  const RealT step_size_x = 20.0; // pixels
  const RealT step_size_y = 20.0; // pixels
  const RealT subset_size = 15.0; // pixels
  schema.initialize(step_size_x,step_size_y,subset_size);

  // There are other ways to initialize a schema 
  // (for example by specifying the number of points and 
  // then setting the coordinates manually)

  // perform the correlation
  schema.execute_correlation();

  // At any point after initialization, the user can access field values
  // by calling field_value(subset_id,field_name)
  // This call enables getting or setting the field value
  // Setting can be used to initialize values prior to calling execute_correlation()
  const RealT point_0_disp_x = schema.field_value(0,DICE::DISPLACEMENT_X);

  // write the output files to the given folder
  schema.write_output("./");

  // print out an image showing the control points and windows 
  // (only enabled if boost is, otherwise this is a no-op)
  schema.write_control_points_image("InitialCPs");

  return 0;
}
</pre><p>The solution for each subset is contained in the data structures of the <a class="el" href="class_d_i_ce_1_1_schema.html" title="The centralized container for the correlation plan and parameters. ">DICe::Schema</a>, to access these values, <a class="el" href="class_d_i_ce_1_1_schema.html" title="The centralized container for the correlation plan and parameters. ">DICe::Schema</a> provides the <code>field_value(const Size subset_id, const std::string &amp; field_name)</code> method. This method can be used to get or set a field value for a specific subset. Valid field names are given in DICe_Types.h.</p>
<h2>Using <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> as a dynamically linked library </h2>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> can also be used in library mode, but a custom interface to the particular application for <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> needs to be written first. (An example of a LabView interface is in <code>\dice\lib\DICE_api.cpp</code>.) Although <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> does not have a standard interface, it is simple to write one that meets the needs of a particular application.</p>
<p>This library is called <code>libdice</code> and resides in the <code>\dice\build\lib\</code> folder.</p>
<p>Using <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> as a library involves writing an interface that sets the parameters and orders the data from the correlation in the right order for the particular application (for the purposes of data exchange). Once this interface is compiled as a library, it can be linked and used in an external application simply by calling the correlation function exposed via the interface.</p>
<h1><a class="anchor" id="BuildingDICE"></a>Building <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> </h1>
<h2>Requirements </h2>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> can be built and run on Mac OS X, Windows, and Linux. The primary intended platforms are Mac OS X and Linux, but Windows builds are also possible. The prerequisite tools required for installing <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> include</p>
<ul>
<li><a href="http://www.cmake.org">CMake</a></li>
<li><a href="http://trilinos.org">Trilinos</a></li>
<li>LAPACK or CLAPACK (for Windows, only CLAPACK is supported)</li>
<li><a href="http://www.boost.org">Boost</a></li>
</ul>
<h2>CMake </h2>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> makes use of CMake for build configuration. Version 2.8 or greater is required. Sample CMake scripts for building Trilinos and <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> are in the folder <code>dice\scripts</code></p>
<h2>Installing Trilinos </h2>
<p>Trilinos contains a set of software packages within an object-oriented software framework used for the solution of large-scale, complex multi-physics engineering and scientific problems. <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> uses some of the packages avaiable in Trilinos and requires that Trilinos be installed.</p>
<p>Trilinos can be downloaded from <a href="http://trilinos.org">http://trilinos.org</a> and build instructions can be found on the getting started page. <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> requires that Trilinos be built with the following packages enabled:</p>
<ul>
<li>Epetra or Tpetra</li>
<li>Kokkos</li>
<li>BLAS</li>
<li>LAPACK</li>
<li>TeuchosCore</li>
<li>TeuchosParameterList</li>
<li>TeuchosNumerics</li>
</ul>
<h2><a class="anchor" id="DICESource"></a>Obtaining <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> source code </h2>
<p><a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> can be cloned from the following git repository </p><pre class="fragment">github.com/dicengine
</pre><p>Please request repository access via the contact information above.</p>
<h3>Setting up your git repository</h3>
<p>If this is your first time using git, you will have to set up your git configurations. To set your user name and email use </p><pre class="fragment">git config --global user.name "Your Name"
git config --global user.email youremail@email.com
</pre><h3>Windows users</h3>
<p>To enable the tests that diff text files to pass, it will be important for Windows git users to add another option to their git configuration </p><pre class="fragment">git config --global core.autocrlf=true
</pre><p>This checks out text files in Windows CRLF format and checks files into the git repo with unix LF format.</p>
<p><b>Note: this must be done before executing the pull command above, doing so after pulling the <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> repository will not work.</b></p>
<h2>Building <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> </h2>
<h3>Mac OSX or Linux</h3>
<p>To build DICEe on Mac OSX or Linux, create a folder in the main directory called build </p><pre class="fragment">$ mkdir build 
</pre><p>Change directory into the build directory and copy the CMake script from the scripts folder. </p><pre class="fragment">$ cd build
$ cp ../scripts/example-do-cmake ./do-cmake
$ chmod +x ./do-cmake
</pre><p>Edit the script to have the correct path locations. Then build <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> </p><pre class="fragment">$ ./do-cmake
$ make
</pre><h3>Windows</h3>
<p>First, download and install CLAPACK from <code><a href="http://www.netlib.org/clapack/">http://www.netlib.org/clapack/</a></code>. In the top level directory, create a file called <code>do-cmake.bat</code> with the contents: </p><pre class="fragment">cmake -D CMAKE_INSTALL_PREFIX:PATH=&lt;install prefix&gt; 
-D CMAKE_BUILD_TYPE:STRING=RELEASE -G "NMake Makefiles" .
</pre><p>Note that the entire do-cmake file should be a single line with no carriage returns. Then execute </p><pre class="fragment">$ do-cmake.bat
$ nmake
</pre><p>Once CLAPACK has built, Trilinos must be built. A sample <code>do-trilinos-cmake-win.bat</code> file is provided in the <code>\dice\scripts</code> folder. The same process for building CLAPACK can be used to build Trilinos and eventually <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a>. A sample <code>do-dice-cmake-win.bat</code> file is also included in the repository in the <code>\dice\scripts</code> folder.</p>
<h2>Boost </h2>
<p>Boost is a required dependency. <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> makes use of the graphics image library in boost. This enables reading standard image formats like <code>.tiff</code> files into <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a>.</p>
<h2>Testing </h2>
<p>To test the installation, from the directory <code>\dice\build\test</code> execute the command (this assumes that <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> has been built in the <code>build</code> directory, otherwise specify the correct path) </p><pre class="fragment">$ ctest
</pre><h2>Compiling <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> with debug messages </h2>
<p>To enable debug messages in <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a>, simply set the CMake flag <code>-D DICE_DEBUG_MSG:BOOL=ON</code> in the <code>do-cmake</code> script.</p>
<h1><a class="anchor" id="CodeDesign"></a>Code Design and Workflow </h1>
<p>A basic outline for how <a class="el" href="namespace_d_i_ce.html" title="generic DICe classes and functions ">DICe</a> performs a correlation is as follows. If more than one image is correlated, the basic workflow is the same, just applied numerous times.</p>
<ul>
<li>The reference and deformed image are read into memory</li>
<li>The correlation parameters are defined</li>
<li>Subsets are defined (for the local algorithm)</li>
<li>The correlation is performed</li>
<li>Results are written to disk</li>
</ul>
<p>All of the correlation parameters are stored in a <code>DICE::Schema</code>, this class controls the algorithms, images, and subset locations. The <code>DICE::Schema</code> also stores the correlation results and all other fields. An image is stored as an array in a <code>DICE::Image</code>. A copy of a portion of the image intensity array is made available through a <code>DICE::Subset</code>. The bulk of the correlation algorithm resides in a <code>DICE::Objective</code>. More details on each of these are provided in the class documentation.</p>
<h1><a class="anchor" id="Legal"></a>Legal </h1>
<p>Sandia National Laboratories is a multi-program laboratory managed and operated by Sandia Corporation, a wholly owned subsidiary of Lockheed Martin Corporation, for the U.S. Department of Energy’s National Nuclear Security Administration under contract DE-AC04-94AL85000.</p>
<h2>License </h2>
<p>Copyright 2015 Sandia Corporation.</p>
<p>Under the terms of Contract DE-AC04-94AL85000 with Sandia Corporation, the U.S. Government retains certain rights in this software.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol type="1">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the Corporation nor the names of the contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY SANDIA CORPORATION “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL SANDIA CORPORATION OR THE CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 16 2015 19:46:13 for Digital Image Correlation Engine by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
